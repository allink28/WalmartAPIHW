package com.github.allink28.tests;

import com.github.allink28.RoboSalesman;
import org.junit.Test;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNull;

/**
 * Created by Allink on 4/2/2016.
 */
public class RoboSalesmanTest {

    @Test
    public void parseInput() throws Exception {
        RoboSalesman wally = new RoboSalesman();

        assertEquals("Jeans", wally.parseInput(new String[] {"Jeans"}));
        assertEquals("Baked beans", wally.parseInput(new String[] {"Baked", "beans"}));
        assertNull(wally.parseInput(new String[3]));
        assertNull(wally.parseInput(new String[1]));
        assertNull(wally.parseInput(new String[0]));
        System.out.println("Finished parseInput() tests");
    }

    @Test
    public void search() throws Exception {
        RoboSalesman wally = new RoboSalesman();
        wally.search("jeans");
        assertEquals("Received HTTP Status code: " + wally.getQueryResponseCode(),
                2, wally.getQueryResponseCode() / 100);
        wally.search("purple jeans");
        assertEquals("Received HTTP Status code: " + wally.getQueryResponseCode(),
                2, wally.getQueryResponseCode() / 100);
    }

    @Test
    public void parseSearchResults() throws Exception {
        String searchResult = "{\"query\":\"purple jeans\",\"sort\":\"relevance\",\"responseGroup\":\"base\",\"totalResults\":14857,\"start\":1,\"numItems\":10,\"items\":\n" +
                "[{\"itemId\":22471486,\"parentItemId\":22471486,\"name\":\"Hanes Men's EcoSmart Fleece Pullover Hood\",\"msrp\":11.0,\"salePrice\":10.0,\"upc\":\"766369059744\",\"categoryPath\":\"Clothing/Young Men's Styles\",\"shortDescription\":\"Get an affordable hoodie from a great brand with Hanes Men's EcoSmart Fleece Pullover Hood. This comfortable hoodie makes an excellent everyday jacket. Wear this hoodie with jeans and sneakers on a cool evening.\",\"longDescription\":\"&lt;br&gt; &lt;b&gt;Hanes Men's EcoSmart Fleece Pullover Hood&lt;/b&gt;: &lt;ul class=&quot;noindent&quot;&gt;&lt;li&gt;50% cotton, 50% polyester&lt;/li&gt;&lt;li&gt;Slip-on design&lt;/li&gt;&lt;li&gt;Long sleeves&lt;/li&gt;&lt;li&gt;Drawstring hood&lt;/li&gt;&lt;li&gt;Rib-band cuffs and hem&lt;/li&gt;&lt;li&gt;Large front kangaroo pocket&lt;/li&gt;&lt;li&gt;Machine wash&lt;/li&gt;&lt;/ul&gt;\",\"thumbnailImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-9784/k2-_536e705e-4ea5-4549-a602-3736a5e59514.v1.jpg\",\"mediumImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-ed01/k2-_86af59e0-fac7-406a-9787-b695dac291cf.v1.jpg\",\"largeImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-3269/k2-_b2adf53b-1ab6-4150-9287-f58be4a6f1e9.v1.jpg\",\"productTrackingUrl\":\"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FFAST-TRACK-Hanes-Men-s-EcoSmart-Fleece-Pullover-Hood%252F22471486%253Faffp1%253DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%2526affilsrc%253Dapi\",\"standardShipRate\":4.97,\"modelNumber\":\"P170\",\"productUrl\":\"http://c.affil.walmart.com/t/api02?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FFAST-TRACK-Hanes-Men-s-EcoSmart-Fleece-Pullover-Hood%2F22471486%3Faffp1%3DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi\",\"customerRating\":\"4.507\",\"numReviews\":482,\"customerRatingImage\":\"http://i2.walmartimages.com/i/CustRating/4_5.gif\",\"categoryNode\":\"5438_547964\",\"bundle\":false,\"stock\":\"Available\",\"addToCartUrl\":\"http://c.affil.walmart.com/t/api02?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D22471486%7C1%26affp1%3DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi\",\"affiliateAddToCartUrl\":\"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D22471486%257C1%2526affp1%253DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%2526affilsrc%253Dapi\",\"giftOptions\":{\"allowGiftWrap\":false,\"allowGiftMessage\":false,\"allowGiftReceipt\":false},\"imageEntities\":[{\"thumbnailImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-9784/k2-_536e705e-4ea5-4549-a602-3736a5e59514.v1.jpg\",\"mediumImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-ed01/k2-_86af59e0-fac7-406a-9787-b695dac291cf.v1.jpg\",\"largeImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-3269/k2-_b2adf53b-1ab6-4150-9287-f58be4a6f1e9.v1.jpg\",\"entityType\":\"PRIMARY\"},{\"thumbnailImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-39ec/k2-_ad50d8a7-d7fe-483e-8479-03b9e2d4d209.v1.jpg\",\"mediumImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-cc95/k2-_967929aa-4b07-41b4-a6a5-c7c9455a0b22.v1.jpg\",\"largeImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-3365/k2-_ff57add8-85ca-4a79-9791-f920054f9d00.v1.jpg\",\"entityType\":\"SECONDARY\"}],\"availableOnline\":true},\n" +
                "{\"itemId\":22471481,\"parentItemId\":22471481,\"name\":\"Hanes Men's EcoSmart Fleece Sweatshirt\",\"salePrice\":7.0,\"upc\":\"766369059171\",\"categoryPath\":\"Clothing/Young Men's Styles\",\"shortDescription\":\"Get an affordable sweatshirt from a great brand with Hanes Men's EcoSmart Fleece Crew. This comfortable sweatshirt makes an excellent and soft jacket option. Wear this hoodie with jeans and sneakers on a cool evening.\",\"longDescription\":\"&lt;br&gt; &lt;b&gt;Hanes Men's EcoSmart Fleece Crew&lt;/b&gt;: &lt;ul class=&quot;noindent&quot;&gt;&lt;li&gt;50% cotton, 50% polyester&lt;/li&gt;&lt;li&gt;Slip-on design&lt;/li&gt;&lt;li&gt;Crew neck&lt;/li&gt;&lt;li&gt;Long sleeves&lt;/li&gt;&lt;li&gt;Rib-band cuffs and hem&lt;/li&gt;&lt;li&gt;Machine wash&lt;/li&gt;&lt;/ul&gt;\",\"thumbnailImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-8085/k2-_dcd4f242-7f4a-4b14-8677-52a5b7e826ef.v1.jpg\",\"mediumImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-6060/k2-_05b3bd81-6420-45bc-aadf-b6a9dd0b9912.v1.jpg\",\"largeImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-4de8/k2-_0e0899a7-71dc-48d8-987d-bd8a6bfcb458.v1.jpg\",\"productTrackingUrl\":\"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FFAST-TRACK-Hanes-Men-s-EcoSmart-Fleece-Crew%252F22471481%253Faffp1%253DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%2526affilsrc%253Dapi\",\"standardShipRate\":4.97,\"modelNumber\":\"P160\",\"productUrl\":\"http://c.affil.walmart.com/t/api02?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FFAST-TRACK-Hanes-Men-s-EcoSmart-Fleece-Crew%2F22471481%3Faffp1%3DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi\",\"customerRating\":\"4.383\",\"numReviews\":407,\"customerRatingImage\":\"http://i2.walmartimages.com/i/CustRating/4_4.gif\",\"categoryNode\":\"5438_547964\",\"bundle\":false,\"stock\":\"Available\",\"addToCartUrl\":\"http://c.affil.walmart.com/t/api02?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D22471481%7C1%26affp1%3DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi\",\"affiliateAddToCartUrl\":\"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D22471481%257C1%2526affp1%253DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%2526affilsrc%253Dapi\",\"giftOptions\":{\"allowGiftWrap\":false,\"allowGiftMessage\":false,\"allowGiftReceipt\":false},\"imageEntities\":[{\"thumbnailImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-8085/k2-_dcd4f242-7f4a-4b14-8677-52a5b7e826ef.v1.jpg\",\"mediumImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-6060/k2-_05b3bd81-6420-45bc-aadf-b6a9dd0b9912.v1.jpg\",\"largeImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-4de8/k2-_0e0899a7-71dc-48d8-987d-bd8a6bfcb458.v1.jpg\",\"entityType\":\"PRIMARY\"}],\"availableOnline\":true},\n" +
                "{\"itemId\":44677697,\"parentItemId\":44677697,\"name\":\"Garanimals Baby Toddler Girl Solid Knit Jeggings\",\"salePrice\":4.0,\"upc\":\"085118483570\",\"categoryPath\":\"Clothing/Baby & Toddler/Baby & Toddler Bottoms/Baby & Toddler Leggings & Tights\",\"shortDescription\":\"Dress your little princess up in style and comfort with these Garanimals Baby Toddler Girls' Knit Jeggings. They are made of a durable cotton, polyester and spandex blend to provide a comfortable fit. These toddler jeggings feature two front faux pockets and belt loops. Cute jean accents and stretchy fabric make them appropriate for everyday wear. These jeggings can easily be paired with tank tops, sweaters, tees and more.\",\"longDescription\":\"&lt;b&gt;&lt;br&gt;Garanimals Girls' Solid Knit Jeggings:&lt;/b&gt;&lt;br&gt;&lt;ul&gt;&lt;li&gt;69% cotton/27% polyester/4% spandex&lt;/li&gt;&lt;li&gt;Garanimals jeggings for baby girl&lt;/li&gt;&lt;li&gt;Machine wash cold&lt;/li&gt;&lt;li&gt;Choose from sizes 12M, 18M, 24M, 3T, 4T and 5T&lt;/li&gt;&lt;li&gt;Available colors: dark pink, dark teal and purple&lt;/li&gt;&lt;/ul&gt;\",\"thumbnailImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-b2c1/k2-_1011c6a5-cce2-4ad6-8625-2621b0912d70.v1.jpg\",\"mediumImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-2e3e/k2-_09034b4e-f964-46b6-9e56-b1689dc9f323.v1.jpg\",\"largeImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-5513/k2-_0e549b6d-4ff7-46c7-b0b6-5e9da44d6b41.v1.jpg\",\"productTrackingUrl\":\"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FGaranimals-Baby-Toddler-Girl-Solid-Knit-Jeggings%252F44677697%253Faffp1%253DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%2526affilsrc%253Dapi\",\"standardShipRate\":4.97,\"marketplace\":false,\"modelNumber\":\"GAG315701 I/T\",\"productUrl\":\"http://c.affil.walmart.com/t/api02?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FGaranimals-Baby-Toddler-Girl-Solid-Knit-Jeggings%2F44677697%3Faffp1%3DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi\",\"categoryNode\":\"5438_584291_1228355\",\"bundle\":false,\"stock\":\"Not available\",\"addToCartUrl\":\"http://c.affil.walmart.com/t/api02?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D44677697%7C1%26affp1%3DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi\",\"affiliateAddToCartUrl\":\"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D44677697%257C1%2526affp1%253DYF95mbyL8RNb19JHt6HYrssSmBI0PJh4mTMrvhOATbI%2526affilsrc%253Dapi\",\"giftOptions\":{\"allowGiftWrap\":false,\"allowGiftMessage\":false,\"allowGiftReceipt\":false},\"imageEntities\":[{\"thumbnailImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-b2c1/k2-_1011c6a5-cce2-4ad6-8625-2621b0912d70.v1.jpg\",\"mediumImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-2e3e/k2-_09034b4e-f964-46b6-9e56-b1689dc9f323.v1.jpg\",\"largeImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-5513/k2-_0e549b6d-4ff7-46c7-b0b6-5e9da44d6b41.v1.jpg\",\"entityType\":\"PRIMARY\"},{\"thumbnailImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-510a/k2-_08e32920-ec27-4e32-bb8b-5bed2d5ff932.v1.jpg\",\"mediumImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-8ca9/k2-_17fc6c6c-e013-4630-8a15-90a3e9014634.v1.jpg\",\"largeImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-bbf9/k2-_3c8f40a9-33f6-411f-b5c6-d8db90a86e80.v1.jpg\",\"entityType\":\"SECONDARY\"}],\"availableOnline\":false}],\"facets\":[]}\n";

        RoboSalesman wally = new RoboSalesman();
        assertEquals(22471486, wally.parseSearchResults(searchResult));

        String malformedJSON = "{\"query\":\"purple jeans\",\"sort\":\"relevance\",\"responseGroup\":\"base\",\"totalResults\":14857,\"start\":1,\"numItems\":10,\"items\":\n" +
                "[{\"itemId\":22471486,\"parentItemId\":22471486,\"name\":\"Hanes Men's EcoSmart Fleece Pullover Hood\",\"msrp\":11.0,\"salePrice\":10.0,\"upc\":\"766369059744\",\"categoryPath\":\"Clothing/Young Men's Styles\",\"shortDescription\":\"Get an affordable hoodie from a great brand with Hanes Men's EcoSmart Fleece Pullover Hood. This comfortable hoodie makes an excellent everyday jacket. Wear this hoodie with jeans and sneakers on a cool evening.\",\"longDescription\":\"&lt;br&gt; &lt;b&gt;Hanes Men's EcoSmart Fleece Pullover Hood&lt;/b&gt;: &lt;ul class=&quot;noindent&quot;&gt;&lt;li&gt;50% cotton, 50% polyester&lt;/li&gt;&lt;li&gt;Slip-on design&lt;/li&gt;&lt;li&gt;Long sleeves&lt;/li&gt;&lt;li&gt;Drawstring DESTROYEDhooBI0PJh4mTMrvhOATbI%2526affilsrc%253Dapi\",\"giftOptions\":{\"allowGiftWrap\":false,\"allowGiftMessage\":false,\"allowGiftReceipt\":false},\"imageEntities\":[{\"thumbnailImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-b2c1/k2-_1011c6a5-cce2-4ad6-8625-2621b0912d70.v1.jpg\",\"mediumImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-2e3e/k2-_09034b4e-f964-46b6-9e56-b1689dc9f323.v1.jpg\",\"largeImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-5513/k2-_0e549b6d-4ff7-46c7-b0b6-5e9da44d6b41.v1.jpg\",\"entityType\":\"PRIMARY\"},{\"thumbnailImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-510a/k2-_08e32920-ec27-4e32-bb8b-5bed2d5ff932.v1.jpg\",\"mediumImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-8ca9/k2-_17fc6c6c-e013-4630-8a15-90a3e9014634.v1.jpg\",\"largeImage\":\"http://i5.walmartimages.com/dfw/dce07b8c-bbf9/k2-_3c8f40a9-33f6-411f-b5c6-d8db90a86e80.v1.jpg\",\"entityType\":\"SECONDARY\"}],\"availableOnline\":false}\"facets\":[]}\n";
        assertEquals(-1, wally.parseSearchResults(malformedJSON));
    }
}